# ddc and its plugins
[[plugins]]
repo = 'Shougo/ddc.vim'
hook_add = '''
call ddc#custom#patch_global('sources', ['file', 'nvim-lsp', 'around', 'ultisnips', 'buffer'])
call ddc#custom#patch_global('sourceOptions', {
    \ 'file': { 'mark': 'F', 'forceCompletionPattern': '\S/\S*'},
    \ 'nvim-lsp': { 'mark':'lsp', 'forceCompletionPattern': '\.\w*|:\w*|->\w*'},
    \ 'around': { 'mark': 'A' },
    \ 'buffer': { 'mark': 'B' },
    \ 'ultisnips': { 'mark': 'US' },
    \ '_': { 'matchers': ['matcher_fuzzy'],
    \        'sorters':  ['sorter_rank'],
    \        'ignoreCase': v:true},
    \   })
call ddc#custom#patch_global('sourceParams', {
    \ 'nvim-lsp': { 'kindLabels': { 'Class': 'c' } },
    \ 'buffer': {'requireSameFiletype': v:false},
    \   })
call ddc#enable()
'''
[[plugins]]
repo = 'Shougo/ddc-nvim-lsp'

[[plugins]]
repo = 'Shougo/ddc-matcher_head'
[[plugins]]
repo = 'matsui54/ddc-matcher_fuzzy'
[[plugins]]
repo = 'matsui54/ddc-ultisnips'
[[plugins]]
repo = 'Shougo/ddc-sorter_rank'
[[plugins]]
repo = 'Shougo/ddc-around'
[[plugins]]
repo = 'matsui54/ddc-buffer'
[[plugins]]
repo = 'LumaKernel/ddc-file'

# LSP configuration
[[plugins]]
repo = 'neovim/nvim-lspconfig'
[[plugins]]
repo = 'williamboman/nvim-lsp-installer'
[[plugins]]
repo = 'ray-x/lsp_signature.nvim'

# Ultisnip and snippet list
[[plugins]]
repo = 'Sirver/ultisnips'
hook_add = '''
" Trigger configuration. You need to change this to something else than <tab> if you use https://github.com/Valloric/YouCompleteMe.
let g:UltiSnipsExpandTrigger="<tab>"
let g:UltiSnipsJumpForwardTrigger="<tab>"
" let g:UltiSnipsJumpBackwardTrigger="<c-b>"

" If you want :UltiSnipsEdit to split your window.
let g:UltiSnipsEditSplit="vertical"
'''
[[plugins]]
repo = 'honza/vim-snippets'

# defx and its plugins
[[plugins]]
repo = 'Shougo/defx.nvim'
hook_add = '''
call defx#custom#column('indent',{'indent': "-"})

let g:defx_default_invocation = "Defx
    \ -new
    \ -auto-cd
    \ -show-ignored-files
    \ -vertical-preview
    \ -preview-width=`min([eval('&columns')-50,float2nr(eval('&columns')*0.8)])`
    \ -columns=time:size:indent:icons:space:space:git:filename
    \ -buffer-name=defx"

nnoremap <silent> [Win]t    :exe g:defx_default_invocation '-split=tab'                   expand('%:p:h') '-search=' . expand('%:p')<CR>
nnoremap <silent> <leader>d :exe g:defx_default_invocation '-split=no'                    expand('%:p:h') '-search=' . expand('%:p')<CR>
nnoremap <silent> <leader>n :exe g:defx_default_invocation '-split=vertical -winwidth=50' expand('%:p:h') '-search=' . expand('%:p')<CR>

autocmd FileType defx call s:defx_my_settings()
function!  s:defx_my_settings() abort
    " Define mappings
    nnoremap <silent><buffer><expr> <CR>          defx#do_action('open')
    nnoremap <silent><buffer><expr> o             defx#is_directory()?defx#do_action('open_or_close_tree'):defx#do_action('drop')
    nnoremap <silent><buffer><expr> O             defx#is_directory()?defx#do_action('open_tree_recursive'):defx#do_action('drop','tabnew')
    nnoremap <silent><buffer><expr> <2-LeftMouse> defx#call_async_action('open')
    nnoremap <silent><buffer><expr> l             defx#call_async_action('open_directory')
    nnoremap <silent><buffer><expr> K             defx#do_action('new_directory')
    nnoremap <silent><buffer><expr> L             defx#do_action('new_file')
    nnoremap <silent><buffer><expr> h             defx#call_async_action('cd', ['..'])
    nnoremap <silent><buffer><expr> d             defx#do_action('remove_trash',[v:true])
    nnoremap <silent><buffer><expr> D             defx#do_action('remove')
    nnoremap <silent><buffer><expr> r             defx#do_action('rename',['..'])
    nnoremap <silent><buffer><expr> ~             defx#call_async_action('cd')
    nnoremap <silent><buffer><expr> v             defx#do_action('toggle_select').'j'
    nnoremap <silent><buffer><expr> R             defx#do_action('redraw')
    nnoremap <silent><buffer><expr> yy            defx#do_action('yank_path')
    nnoremap <silent><buffer><expr> !             defx#do_action('execute_command')
    nnoremap <silent><buffer><expr> i             defx#do_action('execute_command')
    nnoremap <silent><buffer><expr> x             defx#do_action('execute_system')
    nnoremap <silent><buffer><expr> .             defx#do_action('toggle_ignored_files')
    nnoremap <silent><buffer><expr> c             defx#do_action('copy')
    nnoremap <silent><buffer><expr> C             defx#do_action('move')
    nnoremap <silent><buffer><expr> X             defx#do_action('move')
    nnoremap <silent><buffer><expr> p             defx#do_action('preview')
    nnoremap <silent><buffer><expr> P             defx#do_action('paste')
    nnoremap <silent><buffer>       Se            <Cmd>call defx#do_action('toggle_sort', 'extension')<CR><Cmd>call defx#do_action('redraw')<CR>
    nnoremap <silent><buffer>       Sn            <Cmd>call defx#do_action('toggle_sort', 'filename')<CR><Cmd>call defx#do_action('redraw')<CR>
    nnoremap <silent><buffer>       Ss            <Cmd>call defx#do_action('toggle_sort', 'size')<CR><Cmd>call defx#do_action('redraw')<CR>
    nnoremap <silent><buffer>       St            <Cmd>call defx#do_action('toggle_sort', 'time')<CR><Cmd>call defx#do_action('redraw')<CR>
    nnoremap <buffer>               <leader>gd    :call                         <SID>git_diff_of_directory()<CR>
endfunction

function! s:drop_and_back()
    call defx#do_action('open')
    " exe "normal \<C-w>h"
endfunction

function! s:git_diff_of_directory()
    exe "tabnew"
    exe "read !git diff"
    exe "setf diff"
    exe "setlocal buftype=nofile"
    exe "setlocal bufhidden=hide"
    exe "setlocal noswapfile"
endfunction
'''
[[plugins]]
repo = 'kristijanhusak/defx-icons'
[[plugins]]
repo = 'kristijanhusak/defx-git'

# fzf
[[plugins]]
repo = 'junegunn/fzf'
build = './install --bin'
hook_install = '''
fzf#install()
'''
[[plugins]]
repo = 'junegunn/fzf.vim'
depends = 'fzf'
hook_add = '''
nnoremap <silent> <space>fr  <Cmd>History<CR>
nnoremap <silent> <space>ff  <Cmd>Files<CR>
nnoremap <silent> <space>fb  <Cmd>Buffers<CR>
nnoremap <silent> <space>fc  <Cmd>History:<CR>
" nnoremap <silent> <space>fgc  <Cmd>Commits<CR>
nnoremap <silent> <space>fm  <Cmd>Maps<CR>
nnoremap <silent> <space>fh  <Cmd>Helptags<CR>
nnoremap <silent> <space>ft  <Cmd>Tags<CR>
nnoremap <silent> <space>fg  <Cmd>Rg<CR>
'''

[[plugins]]
repo = 'airblade/vim-gitgutter'
hook_add = '''
let g:gitgutter_preview_win_floating = 1
nmap <Leader>hs <Plug>(GitGutterStageHunk)
nmap <Leader>hu <Plug>(GitGutterUndoHunk)
nmap <Leader>hp <Plug>(GitGutterPreviewHunk)
nmap ]h         <Plug>(GitGutterNextHunk)
nmap [h         <Plug>(GitGutterPrevHunk)
omap ih         <Plug>(GitGutterTextObjectInnerPending)
omap ah         <Plug>(GitGutterTextObjectOuterPending)
xmap ih         <Plug>(GitGutterTextObjectInnerVisual)
xmap ah         <Plug>(GitGutterTextObjectOuterVisual)
nmap ]c         <Plug>(GitGutterNextHunk)
nmap [c         <Plug>(GitGutterPrevHunk)
omap ic         <Plug>(GitGutterTextObjectInnerPending)
omap ac         <Plug>(GitGutterTextObjectOuterPending)
xmap ic         <Plug>(GitGutterTextObjectInnerVisual)
xmap ac         <Plug>(GitGutterTextObjectOuterVisual)

nmap <Up> <Plug>(GitGutterStageHunk)
nmap <PageUp> <Plug>(GitGutterPrevHunk)<Plug>(GitGutterPreviewHunk)
nmap <PageDown> <Plug>(GitGutterNextHunk)<Plug>(GitGutterPreviewHunk)
'''

[[plugins]]
repo = 'tpope/vim-fugitive'
hook_add = '''
nnoremap <leader>gs :Git <CR><C-w>T
nnoremap <leader>ga :Gwrite<CR>
nnoremap <leader>gc :Git commit -v<CR>
nnoremap <leader>gb :Git blame<CR>
nnoremap <leader>gh :tab sp<CR>:0Gclog<CR>
nnoremap <leader>gp :Dispatch! git push<CR>
nnoremap <leader>gf :Dispatch! git fetch<CR>
nnoremap <leader>gd :vert :Gdiffsplit<CR>
nnoremap <leader>gr :Git rebase -i<CR>
nnoremap <leader>gg :Glgrep ""<Left>
nnoremap <leader>gm :Git merge 

nnoremap <S-Up> :Gwrite<CR>
nnoremap <C-Up> :Git commit -v<CR>
nnoremap <expr> <Right> '<Cmd>' . (&diff ? 'only' : 'vert Gdiffsplit!') . '<CR>'
nnoremap <expr> <Left> '<Cmd>' . (&ft==#'fugitiveblame' ? 'quit' : 'Git blame') . '<CR>'
nnoremap <Down> :Dispatch! git fetch<CR>
nnoremap <C-Down> :Dispatch! git pull<CR>
'''

# indentline implementation in lua
[[plugins]]
repo = 'lukas-reineke/indent-blankline.nvim'

[[plugins]]
repo = 'majutsushi/tagbar'
hook_add = '''
nmap <leader>t :TagbarToggle<CR>
let g:tagbar_type_go = {
        \ 'ctagstype' : 'go',
        \ 'kinds'     : [
            \ 'p:package',
            \ 'i:imports:1',
            \ 'c:constants',
            \ 'v:variables',
            \ 't:types',
            \ 'n:interfaces',
            \ 'w:fields',
            \ 'e:embedded',
            \ 'm:methods',
            \ 'r:constructor',
            \ 'f:functions'
    \ ],
    \ 'sro' : '.',
    \ 'kind2scope' : {
        \ 't' : 'ctype',
        \ 'n' : 'ntype'
    \ },
    \ 'scope2kind' : {
        \ 'ctype' : 't',
        \ 'ntype' : 'n'
    \ },
    \ 'ctagsbin'  : 'gotags',
    \ 'ctagsargs' : '-sort -silent'
\ }

let g:tagbar_sort = 0
let g:tagbar_autoclose = 0
'''

[[plugins]]
repo = 'mbbill/undotree'
hook_add = '''
nnoremap U :UndotreeToggle<CR>
'''

[[plugins]]
repo = 'itchyny/lightline.vim'
hook_add = '''
let g:lightline = {
            \  'colorscheme': 'iceberg',
            \  'active': {
                \     'right' : [ [ 'lineinfo' ],
                \            [ 'percent', 'editdistance', 'fileencoding' ],
                \            [ 'fileformat', 'fileencoding', 'filetype' ] ]
                \ },
                \ 'component_function': {
                    \    'editdistance': 'NovelPreviewEditDistance',
                    \}
                \}
let g:lightline.separator = { 'left': "\ue0b8", 'right': "\ue0be" }
let g:lightline.subseparator = { 'left':  "\ue0b9", 'right': "\ue0b9"  }
let g:lightline.tabline_separator = { 'left': "\ue0bc", 'right': "\ue0ba" }
let g:lightline.tabline_subseparator = { 'left': "\ue0bb", 'right': "\ue0bb" }
'''

[[plugins]]
repo = 'jpalardy/vim-slime'
hook_add = '''
nmap <c-c><c-c> <Plug>SlimeParagraphSend
nmap <c-c><c-n> <Plug>SlimeParagraphSend}/[^\n]<CR>
nmap <c-c><c-p> <Plug>SlimeParagraphSend{?[^\n]<CR>
'''

[[plugins]]
repo = 'skywind3000/asyncrun.vim'
hook_add = '''
let g:asyncrun_bell=1
let g:asyncrun_open = 8
'''

[[plugins]]
repo = 'woodyZootopia/gitsession.vim'
hook_add = '''
let g:gitsession_autosave = 1
let g:gitsession_tmp_dir = g:nvim_home_directory .. '/tmp/gitsession'
'''

[[plugins]]
repo = 'LeafCage/vimhelpgenerator.git'

[[plugins]]
repo = 'tversteeg/registers.nvim'

# colorscheme
[[plugins]]
# repo = '~/ghq/github.com/woodyZootopia/iceberg.vim'
repo = 'cocopon/iceberg.vim'
[[plugins]]
repo = 'cocopon/pgmnt.vim'
[[plugins]]
repo = 'cocopon/inspecthi.vim'
[[plugins]]
repo = 'cocopon/colorswatch.vim'

[[plugins]]
repo = 'gamoutatsumi/dps-ghosttext.vim'
hook_post_source = '''
let g:dps_ghosttext#ftmap['www.overleaf.com']='tex'
'''

[[plugins]]
repo = 'nvim-treesitter/nvim-treesitter'
merged = '0'
hook_post_source = '''
lua <<EOF
require'nvim-treesitter.configs'.setup {
  highlight = {
    enable = true,
    disable = {
      'lua',
      'toml',
      'tex',
      'latex',
    }
  },
  indent = {
    enable = false
  }
  -- ensure_installed = 'maintained'
}
EOF
'''
hook_install = 'TSUpdate'
hook_post_update = 'TSUpdate'

[[plugins]]
repo = 'justinmk/vim-sneak'
hook_post_source = '''
map t <Plug>Sneak_s
map T <Plug>Sneak_S
'''

[[plugins]]
repo = 'cohama/agit.vim'
hook_add = '''
nnoremap <leader>gl :Agit<CR>
'''
